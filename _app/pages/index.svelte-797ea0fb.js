var it=Object.defineProperty,ot=Object.defineProperties;var ct=Object.getOwnPropertyDescriptors;var Te=Object.getOwnPropertySymbols;var ut=Object.prototype.hasOwnProperty,dt=Object.prototype.propertyIsEnumerable;var Le=(t,e,r)=>e in t?it(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,K=(t,e)=>{for(var r in e||(e={}))ut.call(e,r)&&Le(t,r,e[r]);if(Te)for(var r of Te(e))dt.call(e,r)&&Le(t,r,e[r]);return t},_e=(t,e)=>ot(t,ct(e));import{S as oe,i as ce,s as ue,H as Me,e as h,k as M,c as _,a as p,d as u,n as R,b as g,f as N,F as f,I as Re,J as Ne,K as We,x as P,u as W,E as Be,G as Z,L as te,M as ft,W as ht,N as _t,O as pt,P as gt,t as x,g as ee,j as pe,m as ge,o as ve,v as me,r as be,w as ye,Q as ze,R as de,T as Ge,U as fe,V as vt,h as mt,X as He,Y as bt}from"../chunks/vendor-309c7e4b.js";const yt=t=>({}),Je=t=>({}),Et=t=>({}),Ue=t=>({});function qt(t){let e,r,s,a,i,l;const d=t[1].title,c=Me(d,t,t[0],Ue),E=t[1].desc,y=Me(E,t,t[0],Je);return{c(){e=h("div"),r=h("div"),s=h("h4"),c&&c.c(),a=M(),i=h("p"),y&&y.c(),this.h()},l(v){e=_(v,"DIV",{class:!0});var b=p(e);r=_(b,"DIV",{class:!0});var D=p(r);s=_(D,"H4",{class:!0});var z=p(s);c&&c.l(z),z.forEach(u),a=R(D),i=_(D,"P",{class:!0});var A=p(i);y&&y.l(A),A.forEach(u),D.forEach(u),b.forEach(u),this.h()},h(){g(s,"class","fr-tile__title"),g(i,"class","rf-tile__desc fr-mt-0 fr-mb-0"),g(r,"class","fr-tile__body"),g(e,"class","fr-tile")},m(v,b){N(v,e,b),f(e,r),f(r,s),c&&c.m(s,null),f(r,a),f(r,i),y&&y.m(i,null),l=!0},p(v,[b]){c&&c.p&&(!l||b&1)&&Re(c,d,v,v[0],l?We(d,v[0],b,Et):Ne(v[0]),Ue),y&&y.p&&(!l||b&1)&&Re(y,E,v,v[0],l?We(E,v[0],b,yt):Ne(v[0]),Je)},i(v){l||(P(c,v),P(y,v),l=!0)},o(v){W(c,v),W(y,v),l=!1},d(v){v&&u(e),c&&c.d(v),y&&y.d(v)}}}function wt(t,e,r){let{$$slots:s={},$$scope:a}=e;return t.$$set=i=>{"$$scope"in i&&r(0,a=i.$$scope)},[a,s]}class Dt extends oe{constructor(e){super();ce(this,e,wt,qt,ue,{})}}function It(t){let e;return{c(){e=h("canvas"),this.h()},l(r){e=_(r,"CANVAS",{style:!0}),p(e).forEach(u),this.h()},h(){Be(e,"height",t[0]||"250px")},m(r,s){N(r,e,s),t[5](e)},p(r,[s]){s&1&&Be(e,"height",r[0]||"250px")},i:Z,o:Z,d(r){r&&u(e),t[5](null)}}}function Vt(t,e,r){let{type:s="line"}=e,{data:a}=e,{height:i}=e,{options:l={}}=e;te.register(...ft),te.register(ht,_t),te.register(pt),te.defaults.font.family='"Marianne"';let d,c,E;function y(){E=d.getContext("2d"),c&&c.destroy(),c=new te(E,{type:s,data:a,options:l})}function v(b){gt[b?"unshift":"push"](()=>{d=b,r(1,d)})}return t.$$set=b=>{"type"in b&&r(2,s=b.type),"data"in b&&r(3,a=b.data),"height"in b&&r(0,i=b.height),"options"in b&&r(4,l=b.options)},t.$$.update=()=>{t.$$.dirty&8&&a&&y()},[i,d,s,a,l,v]}class $t extends oe{constructor(e){super();ce(this,e,Vt,It,ue,{type:2,data:3,height:0,options:4})}}function Fe(t,e,r){const s=t.slice();return s[16]=e[r],s[18]=r,s}function Ke(t,e,r){const s=t.slice();return s[19]=e[r],s}function Qe(t,e,r){const s=t.slice();return s[22]=e[r],s}function Xe(t,e,r){const s=t.slice();return s[25]=e[r],s}function Ye(t){let e,r=t[25].label+"",s,a,i;return{c(){e=h("option"),s=x(r),a=M(),this.h()},l(l){e=_(l,"OPTION",{});var d=p(e);s=ee(d,r),a=R(d),d.forEach(u),this.h()},h(){e.__value=i=t[25],e.value=e.__value},m(l,d){N(l,e,d),f(e,s),f(e,a)},p:Z,d(l){l&&u(e)}}}function Ze(t){let e,r=t[22].label+"",s,a,i;return{c(){e=h("option"),s=x(r),a=M(),this.h()},l(l){e=_(l,"OPTION",{});var d=p(e);s=ee(d,r),a=R(d),d.forEach(u),this.h()},h(){e.__value=i=t[22],e.value=e.__value},m(l,d){N(l,e,d),f(e,s),f(e,a)},p:Z,d(l){l&&u(e)}}}function xe(t){let e,r;return e=new Dt({props:{$$slots:{desc:[Ct],title:[kt]},$$scope:{ctx:t}}}),{c(){pe(e.$$.fragment)},l(s){ge(e.$$.fragment,s)},m(s,a){ve(e,s,a),r=!0},p(s,a){const i={};a&268435460&&(i.$$scope={dirty:a,ctx:s}),e.$set(i)},i(s){r||(P(e.$$.fragment,s),r=!0)},o(s){W(e.$$.fragment,s),r=!1},d(s){me(e,s)}}}function kt(t){let e,r=t[2][t[19]].data+"",s;return{c(){e=h("span"),s=x(r),this.h()},l(a){e=_(a,"SPAN",{slot:!0});var i=p(e);s=ee(i,r),i.forEach(u),this.h()},h(){g(e,"slot","title")},m(a,i){N(a,e,i),f(e,s)},p(a,i){i&4&&r!==(r=a[2][a[19]].data+"")&&mt(s,r)},d(a){a&&u(e)}}}function Ct(t){let e,r=t[4][t[19]]+"",s;return{c(){e=h("span"),s=x(r),this.h()},l(a){e=_(a,"SPAN",{slot:!0});var i=p(e);s=ee(i,r),i.forEach(u),this.h()},h(){g(e,"slot","desc")},m(a,i){N(a,e,i),f(e,s)},p:Z,d(a){a&&u(e)}}}function et(t){let e,r,s,a=t[2][t[19]]&&xe(t);return{c(){e=h("div"),a&&a.c(),r=M(),this.h()},l(i){e=_(i,"DIV",{class:!0});var l=p(e);a&&a.l(l),r=R(l),l.forEach(u),this.h()},h(){g(e,"class","fr-col")},m(i,l){N(i,e,l),a&&a.m(e,null),f(e,r),s=!0},p(i,l){i[2][i[19]]?a?(a.p(i,l),l&4&&P(a,1)):(a=xe(i),a.c(),P(a,1),a.m(e,r)):a&&(be(),W(a,1,1,()=>{a=null}),ye())},i(i){s||(P(a),s=!0)},o(i){W(a),s=!1},d(i){i&&u(e),a&&a.d()}}}function tt(t){let e,r,s,a,i;return r=new $t({props:{height:t[16].height,type:t[16].type,data:t[2][t[16].query]&&K({},t[7](t[2][t[16].query].data,t[16].query,t[2][t[16].query].type,t[16].chartType,t[16].fill)),options:K({plugins:{datalabels:{color:"#ffffff"},title:{display:!0,text:t[4][t[16].query]},legend:{display:t[16].legend}}},t[2][t[16].query]&&t[2][t[16].query].type==="time_series"?_e(K({},t[8]),{scales:{x:{type:"time"}}}):t[8])}}),{c(){e=h("div"),pe(r.$$.fragment),s=M(),this.h()},l(l){e=_(l,"DIV",{class:!0});var d=p(e);ge(r.$$.fragment,d),s=R(d),d.forEach(u),this.h()},h(){g(e,"class",a="fr-col-12 fr-col-md-"+(t[16].col||6))},m(l,d){N(l,e,d),ve(r,e,null),f(e,s),i=!0},p(l,d){const c={};d&4&&(c.data=l[2][l[16].query]&&K({},l[7](l[2][l[16].query].data,l[16].query,l[2][l[16].query].type,l[16].chartType,l[16].fill))),d&4&&(c.options=K({plugins:{datalabels:{color:"#ffffff"},title:{display:!0,text:l[4][l[16].query]},legend:{display:l[16].legend}}},l[2][l[16].query]&&l[2][l[16].query].type==="time_series"?_e(K({},l[8]),{scales:{x:{type:"time"}}}):l[8])),r.$set(c)},i(l){i||(P(r.$$.fragment,l),i=!0)},o(l){W(r.$$.fragment,l),i=!1},d(l){l&&u(e),me(r)}}}function jt(t){let e,r,s,a,i,l,d,c,E,y,v,b,D,z,A,G,I,H,V,re,B,j,O,le,L,T,J,se,he,Ee,Q=t[5],$=[];for(let o=0;o<Q.length;o+=1)$[o]=Ye(Xe(t,Q,o));let X=t[6],k=[];for(let o=0;o<X.length;o+=1)k[o]=Ze(Qe(t,X,o));let U=t[3].filter(rt).map(lt),q=[];for(let o=0;o<U.length;o+=1)q[o]=et(Ke(t,U,o));const at=o=>W(q[o],1,1,()=>{q[o]=null});let F=t[3].filter(st),w=[];for(let o=0;o<F.length;o+=1)w[o]=tt(Fe(t,F,o));const nt=o=>W(w[o],1,1,()=>{w[o]=null});return{c(){e=h("div"),r=h("div"),s=h("div"),a=h("div"),i=h("div"),l=h("div"),d=h("div"),c=h("div"),E=h("div"),y=h("label"),v=x("Plage de dates"),b=M(),D=h("select");for(let o=0;o<$.length;o+=1)$[o].c();z=M(),A=h("div"),G=h("label"),I=x("Environnement"),H=M(),V=h("select");for(let o=0;o<k.length;o+=1)k[o].c();re=M(),B=h("div"),j=h("div"),O=h("div");for(let o=0;o<q.length;o+=1)q[o].c();le=M(),L=h("div"),T=h("div"),J=h("div");for(let o=0;o<w.length;o+=1)w[o].c();this.h()},l(o){e=_(o,"DIV",{class:!0});var m=p(e);r=_(m,"DIV",{class:!0});var n=p(r);s=_(n,"DIV",{class:!0});var S=p(s);a=_(S,"DIV",{class:!0});var qe=p(a);i=_(qe,"DIV",{class:!0});var Y=p(i);l=_(Y,"DIV",{class:!0});var we=p(l);d=_(we,"DIV",{class:!0});var De=p(d);c=_(De,"DIV",{class:!0});var ae=p(c);E=_(ae,"DIV",{class:!0});var ne=p(E);y=_(ne,"LABEL",{class:!0,for:!0});var Ie=p(y);v=ee(Ie,"Plage de dates"),Ie.forEach(u),b=R(ne),D=_(ne,"SELECT",{id:!0,class:!0});var Ve=p(D);for(let C=0;C<$.length;C+=1)$[C].l(Ve);Ve.forEach(u),ne.forEach(u),z=R(ae),A=_(ae,"DIV",{class:!0});var ie=p(A);G=_(ie,"LABEL",{class:!0,for:!0});var $e=p(G);I=ee($e,"Environnement"),$e.forEach(u),H=R(ie),V=_(ie,"SELECT",{id:!0,class:!0});var ke=p(V);for(let C=0;C<k.length;C+=1)k[C].l(ke);ke.forEach(u),ie.forEach(u),ae.forEach(u),De.forEach(u),we.forEach(u),re=R(Y),B=_(Y,"DIV",{class:!0});var Ce=p(B);j=_(Ce,"DIV",{class:!0});var je=p(j);O=_(je,"DIV",{class:!0});var Oe=p(O);for(let C=0;C<q.length;C+=1)q[C].l(Oe);Oe.forEach(u),je.forEach(u),Ce.forEach(u),le=R(Y),L=_(Y,"DIV",{class:!0});var Se=p(L);T=_(Se,"DIV",{class:!0});var Pe=p(T);J=_(Pe,"DIV",{class:!0});var Ae=p(J);for(let C=0;C<w.length;C+=1)w[C].l(Ae);Ae.forEach(u),Pe.forEach(u),Se.forEach(u),Y.forEach(u),qe.forEach(u),S.forEach(u),n.forEach(u),m.forEach(u),this.h()},h(){g(y,"class","fr-label"),g(y,"for","date"),g(D,"id","date"),g(D,"class","fr-select"),t[0]===void 0&&ze(()=>t[9].call(D)),g(E,"class","fr-col-6"),g(G,"class","fr-label"),g(G,"for","cluster"),g(V,"id","cluster"),g(V,"class","fr-select"),t[1]===void 0&&ze(()=>t[10].call(V)),g(A,"class","fr-col-6"),g(c,"class","fr-grid-row fr-grid-row--gutters"),g(d,"class","fr-container fr-container--fluid"),g(l,"class","fr-col-12"),g(O,"class","fr-grid-row fr-grid-row--gutters fr-grid-row--center"),g(j,"class","fr-container fr-container--fluid"),g(B,"class","fr-col-12"),g(J,"class","fr-grid-row fr-grid-row--gutters fr-grid-row--center"),g(T,"class","fr-container fr-container--fluid"),g(L,"class","fr-col-12"),g(i,"class","fr-grid-row fr-grid-row--gutters fr-grid-row--center"),g(a,"class","fr-container fr-container--fluid"),g(s,"class","fr-col-12"),g(r,"class","fr-grid-row fr-grid-row--gutters"),g(e,"class","fr-container fr-container--fluid")},m(o,m){N(o,e,m),f(e,r),f(r,s),f(s,a),f(a,i),f(i,l),f(l,d),f(d,c),f(c,E),f(E,y),f(y,v),f(E,b),f(E,D);for(let n=0;n<$.length;n+=1)$[n].m(D,null);de(D,t[0]),f(c,z),f(c,A),f(A,G),f(G,I),f(A,H),f(A,V);for(let n=0;n<k.length;n+=1)k[n].m(V,null);de(V,t[1]),f(i,re),f(i,B),f(B,j),f(j,O);for(let n=0;n<q.length;n+=1)q[n].m(O,null);f(i,le),f(i,L),f(L,T),f(T,J);for(let n=0;n<w.length;n+=1)w[n].m(J,null);se=!0,he||(Ee=[Ge(D,"change",t[9]),Ge(V,"change",t[10])],he=!0)},p(o,[m]){if(m&32){Q=o[5];let n;for(n=0;n<Q.length;n+=1){const S=Xe(o,Q,n);$[n]?$[n].p(S,m):($[n]=Ye(S),$[n].c(),$[n].m(D,null))}for(;n<$.length;n+=1)$[n].d(1);$.length=Q.length}if(m&33&&de(D,o[0]),m&64){X=o[6];let n;for(n=0;n<X.length;n+=1){const S=Qe(o,X,n);k[n]?k[n].p(S,m):(k[n]=Ze(S),k[n].c(),k[n].m(V,null))}for(;n<k.length;n+=1)k[n].d(1);k.length=X.length}if(m&66&&de(V,o[1]),m&28){U=o[3].filter(rt).map(lt);let n;for(n=0;n<U.length;n+=1){const S=Ke(o,U,n);q[n]?(q[n].p(S,m),P(q[n],1)):(q[n]=et(S),q[n].c(),P(q[n],1),q[n].m(O,null))}for(be(),n=U.length;n<q.length;n+=1)at(n);ye()}if(m&412){F=o[3].filter(st);let n;for(n=0;n<F.length;n+=1){const S=Fe(o,F,n);w[n]?(w[n].p(S,m),P(w[n],1)):(w[n]=tt(S),w[n].c(),P(w[n],1),w[n].m(J,null))}for(be(),n=F.length;n<w.length;n+=1)nt(n);ye()}},i(o){if(!se){for(let m=0;m<U.length;m+=1)P(q[m]);for(let m=0;m<F.length;m+=1)P(w[m]);se=!0}},o(o){q=q.filter(Boolean);for(let m=0;m<q.length;m+=1)W(q[m]);w=w.filter(Boolean);for(let m=0;m<w.length;m+=1)W(w[m]);se=!1},d(o){o&&u(e),fe($,o),fe(k,o),fe(q,o),fe(w,o),he=!1,vt(Ee)}}}let Ot=50;const rt=t=>t.type==="number",lt=t=>t.query,st=t=>t.type!=="number";function St(t,e,r){const s=[{query:"api_requests_number",type:"number"},{query:"decision_uniq_number",type:"number"},{query:"pods_number",type:"number"},{query:"api_requests_date_histogram",type:"line",legend:!0},{query:"errors_histogram",type:"bar",legend:!1},{query:"requests_ip_source",type:"pie",legend:!0},{query:"latencty_date_histogram",type:"line",fill:!0,legend:!0},{query:"cpu_date_histogram",type:"line",fill:!0,legend:!0},{query:"mem_date_histogram",type:"line",fill:!0,legend:!0},{query:"bandwidth_date_histogram",type:"line",legend:!1},{query:"top_words",type:"bar",height:"400px",col:12,legend:!1}],a={api_requests_number:"Appels API",api_requests_date_histogram:"Requ\xEAtes",decision_uniq_number:"D\xE9cisions consult\xE9es",errors_histogram:"Erreurs http",requests_ip_source:"Canal d'appel",latencty_date_histogram:"Latence",cpu_date_histogram:"CPU %",mem_date_histogram:"M\xE9moire",bandwidth_date_histogram:"R\xE9seau (octets)",top_words:"Recherches",pods_number:"Conteneurs"},i=[{label:"Dernier jour",start:"now-1d",end:"now",step:"30m"},{label:"Derni\xE8re heure",start:"now-1h",end:"now",step:"2m"},{label:"Derni\xE8re semaine",start:"now-7d",end:"now",step:"12h"},{label:"Dernier mois",start:"now-30d",end:"now",step:"1d"},{label:"Depuis le d\xE9but",start:"2020-01-01T00:00:00",end:"now",step:"1d"}];let l=i[0];const d=[{label:"Production",name:"judilibre-scw-prod-par2"},{label:"Secours",name:"judilibre-scw-prod-par1"},{label:"Recette",name:"judilibre-scw-dev-par1"}];let c=d[0],E={};const y=(I,H,V,re,B)=>{if(V==="time_series"){let j=0,O={};return I.forEach(L=>{Object.keys(L).forEach(T=>{T!=="date"&&(O[T]=!0)})}),O=Object.keys(O),O.includes("Mem.total")&&(O=["Mem.used.min","Mem.used.mean","Mem.used.max","Mem.total"]),{datasets:O.map(L=>({data:I.map(T=>{if(T[L])return{x:new Date(T.date),y:T[L]}}),label:L,borderColor:z[j++],borderWidth:B?0:void 0,fill:B?"origin":void 0,backgroundColor:B?`#000091${9-2*j}${9-2*j}`:void 0}))}}else return{datasets:[{data:Object.keys(I).map(j=>I[j]),backgroundColor:z,borderWidth:0,label:a[H]}],labels:Object.keys(I).map(j=>b(j))}},v={"80.87.226.10":"courdecassation.fr","185.24.185.49":"piste.gouv.fr"},b=I=>v[I]||I,D={responsive:!0,maintainAspectRatio:!1,animation:{duration:0},interaction:{mode:"index"},hover:{intersect:!1},elements:{point:{radius:0},line:{tension:0}}},z=["#4dc9f6","#f67019","#f53794","#537bc4","#acc236","#166a8f","#00a950","#58595b","#8549ba"];function A(){l=He(this),r(0,l),r(5,i)}function G(){c=He(this),r(1,c),r(6,d)}return t.$$.update=()=>{t.$$.dirty&3&&(l||c)&&s.forEach(I=>{fetch(new Request(`https://monitor.judilibre.io/stats?query=${I.query}&date_start=${l.start}&date_end=${l.end}&date_interval=${l.step}&cluster=${c.name}&size=${Ot}`,{method:"GET",referer:"https://stats.judilibre.io",mode:"cors"})).then(H=>{if(H.ok)return H.json().then(V=>{r(2,E[I.query]=V[I.query],E)})})})},[l,c,E,s,a,i,d,y,D,A,G]}class Pt extends oe{constructor(e){super();ce(this,e,St,jt,ue,{})}}function At(t){let e,r,s,a,i,l,d;return l=new Pt({}),{c(){e=M(),r=h("section"),s=h("div"),a=h("div"),i=h("div"),pe(l.$$.fragment),this.h()},l(c){bt('[data-svelte="svelte-9qr2em"]',document.head).forEach(u),e=R(c),r=_(c,"SECTION",{});var y=p(r);s=_(y,"DIV",{class:!0});var v=p(s);a=_(v,"DIV",{class:!0});var b=p(a);i=_(b,"DIV",{class:!0});var D=p(i);ge(l.$$.fragment,D),D.forEach(u),b.forEach(u),v.forEach(u),y.forEach(u),this.h()},h(){document.title="API Judilibre - statistiques",g(i,"class","fr-col-12 fr-mt-2w"),g(a,"class","fr-grid-row fr-grid-row--gutters fr-grid-row--center"),g(s,"class","fr-container")},m(c,E){N(c,e,E),N(c,r,E),f(r,s),f(s,a),f(a,i),ve(l,i,null),d=!0},p:Z,i(c){d||(P(l.$$.fragment,c),d=!0)},o(c){W(l.$$.fragment,c),d=!1},d(c){c&&u(e),c&&u(r),me(l)}}}const Mt=!0;class Rt extends oe{constructor(e){super();ce(this,e,null,At,ue,{})}}export{Rt as default,Mt as prerender};

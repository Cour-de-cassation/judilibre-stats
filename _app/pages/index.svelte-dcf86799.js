var Qe=Object.defineProperty,Xe=Object.defineProperties;var Ye=Object.getOwnPropertyDescriptors;var we=Object.getOwnPropertySymbols;var Ze=Object.prototype.hasOwnProperty,xe=Object.prototype.propertyIsEnumerable;var De=(t,e,s)=>e in t?Qe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,F=(t,e)=>{for(var s in e||(e={}))Ze.call(e,s)&&De(t,s,e[s]);if(we)for(var s of we(e))xe.call(e,s)&&De(t,s,e[s]);return t},ce=(t,e)=>Xe(t,Ye(e));import{S as le,i as ae,s as ne,H as Ie,e as g,k as B,c as v,a as b,d as f,n as z,b as y,f as A,F as h,I as Ve,J as $e,K as ke,x as O,u as L,E as Ce,G as Q,L as Z,M as et,W as tt,N as st,O as rt,P as lt,t as X,g as Y,j as ue,m as fe,o as de,v as he,r as _e,w as pe,Q as je,R as ie,T as Oe,U as oe,V as at,h as nt,X as Se,Y as it}from"../chunks/vendor-309c7e4b.js";const ot=t=>({}),Pe=t=>({}),ct=t=>({}),Te=t=>({});function ut(t){let e,s,r,n,i,l;const c=t[1].title,u=Ie(c,t,t[0],Te),w=t[1].desc,_=Ie(w,t,t[0],Pe);return{c(){e=g("div"),s=g("div"),r=g("h4"),u&&u.c(),n=B(),i=g("p"),_&&_.c(),this.h()},l(p){e=v(p,"DIV",{class:!0});var d=b(e);s=v(d,"DIV",{class:!0});var D=b(s);r=v(D,"H4",{class:!0});var M=b(r);u&&u.l(M),M.forEach(f),n=z(D),i=v(D,"P",{class:!0});var G=b(i);_&&_.l(G),G.forEach(f),D.forEach(f),d.forEach(f),this.h()},h(){y(r,"class","fr-tile__title"),y(i,"class","rf-tile__desc fr-mt-0 fr-mb-0"),y(s,"class","fr-tile__body"),y(e,"class","fr-tile")},m(p,d){A(p,e,d),h(e,s),h(s,r),u&&u.m(r,null),h(s,n),h(s,i),_&&_.m(i,null),l=!0},p(p,[d]){u&&u.p&&(!l||d&1)&&Ve(u,c,p,p[0],l?ke(c,p[0],d,ct):$e(p[0]),Te),_&&_.p&&(!l||d&1)&&Ve(_,w,p,p[0],l?ke(w,p[0],d,ot):$e(p[0]),Pe)},i(p){l||(O(u,p),O(_,p),l=!0)},o(p){L(u,p),L(_,p),l=!1},d(p){p&&f(e),u&&u.d(p),_&&_.d(p)}}}function ft(t,e,s){let{$$slots:r={},$$scope:n}=e;return t.$$set=i=>{"$$scope"in i&&s(0,n=i.$$scope)},[n,r]}class dt extends le{constructor(e){super();ae(this,e,ft,ut,ne,{})}}function ht(t){let e;return{c(){e=g("canvas"),this.h()},l(s){e=v(s,"CANVAS",{style:!0}),b(e).forEach(f),this.h()},h(){Ce(e,"height",t[0])},m(s,r){A(s,e,r),t[5](e)},p(s,[r]){r&1&&Ce(e,"height",s[0])},i:Q,o:Q,d(s){s&&f(e),t[5](null)}}}function _t(t,e,s){let{type:r="line"}=e,{data:n}=e,{height:i="150px"}=e,{options:l={}}=e;Z.register(...et),Z.register(tt,st),Z.register(rt),Z.defaults.font.family='"Marianne"';let c,u,w;function _(){w=c.getContext("2d"),u&&u.destroy(),u=new Z(w,{type:r,data:n,options:l})}function p(d){lt[d?"unshift":"push"](()=>{c=d,s(1,c)})}return t.$$set=d=>{"type"in d&&s(2,r=d.type),"data"in d&&s(3,n=d.data),"height"in d&&s(0,i=d.height),"options"in d&&s(4,l=d.options)},t.$$.update=()=>{t.$$.dirty&8&&n&&_()},[i,c,r,n,l,p]}class pt extends le{constructor(e){super();ae(this,e,_t,ht,ne,{type:2,data:3,height:0,options:4})}}function Ae(t,e,s){const r=t.slice();return r[16]=e[s],r[18]=s,r}function Le(t,e,s){const r=t.slice();return r[19]=e[s],r}function Ne(t,e,s){const r=t.slice();return r[22]=e[s],r}function Re(t,e,s){const r=t.slice();return r[25]=e[s],r}function Be(t){let e,s=t[25].label+"",r,n,i;return{c(){e=g("option"),r=X(s),n=B(),this.h()},l(l){e=v(l,"OPTION",{});var c=b(e);r=Y(c,s),n=z(c),c.forEach(f),this.h()},h(){e.__value=i=t[25],e.value=e.__value},m(l,c){A(l,e,c),h(e,r),h(e,n)},p:Q,d(l){l&&f(e)}}}function ze(t){let e,s=t[22].label+"",r,n,i;return{c(){e=g("option"),r=X(s),n=B(),this.h()},l(l){e=v(l,"OPTION",{});var c=b(e);r=Y(c,s),n=z(c),c.forEach(f),this.h()},h(){e.__value=i=t[22],e.value=e.__value},m(l,c){A(l,e,c),h(e,r),h(e,n)},p:Q,d(l){l&&f(e)}}}function Me(t){let e,s;return e=new dt({props:{$$slots:{desc:[gt],title:[mt]},$$scope:{ctx:t}}}),{c(){ue(e.$$.fragment)},l(r){fe(e.$$.fragment,r)},m(r,n){de(e,r,n),s=!0},p(r,n){const i={};n&268435460&&(i.$$scope={dirty:n,ctx:r}),e.$set(i)},i(r){s||(O(e.$$.fragment,r),s=!0)},o(r){L(e.$$.fragment,r),s=!1},d(r){he(e,r)}}}function mt(t){let e,s=t[2][t[19]].data+"",r;return{c(){e=g("span"),r=X(s),this.h()},l(n){e=v(n,"SPAN",{slot:!0});var i=b(e);r=Y(i,s),i.forEach(f),this.h()},h(){y(e,"slot","title")},m(n,i){A(n,e,i),h(e,r)},p(n,i){i&4&&s!==(s=n[2][n[19]].data+"")&&nt(r,s)},d(n){n&&f(e)}}}function gt(t){let e,s=t[4][t[19]]+"",r;return{c(){e=g("span"),r=X(s),this.h()},l(n){e=v(n,"SPAN",{slot:!0});var i=b(e);r=Y(i,s),i.forEach(f),this.h()},h(){y(e,"slot","desc")},m(n,i){A(n,e,i),h(e,r)},p:Q,d(n){n&&f(e)}}}function We(t){let e,s,r=t[2][t[19]]&&Me(t);return{c(){e=g("div"),r&&r.c(),this.h()},l(n){e=v(n,"DIV",{class:!0});var i=b(e);r&&r.l(i),i.forEach(f),this.h()},h(){y(e,"class","fr-col-4")},m(n,i){A(n,e,i),r&&r.m(e,null),s=!0},p(n,i){n[2][n[19]]?r?(r.p(n,i),i&4&&O(r,1)):(r=Me(n),r.c(),O(r,1),r.m(e,null)):r&&(_e(),L(r,1,1,()=>{r=null}),pe())},i(n){s||(O(r),s=!0)},o(n){L(r),s=!1},d(n){n&&f(e),r&&r.d()}}}function Ge(t){let e,s,r,n,i;return s=new pt({props:{height:t[16].height||"150px",type:t[16].type,data:t[2][t[16].query]&&F({},t[7](t[2][t[16].query].data,t[16].query,t[2][t[16].query].type,t[16].chartType)),options:F({plugins:{title:{display:!0,text:t[4][t[16].query]},legend:{display:t[2][t[16].query]&&t[2][t[16].query].type==="time_series"}}},t[2][t[16].query]&&t[2][t[16].query].type==="time_series"?ce(F({},t[8]),{scales:{x:{type:"time"}}}):t[8])}}),{c(){e=g("div"),ue(s.$$.fragment),r=B(),this.h()},l(l){e=v(l,"DIV",{class:!0});var c=b(e);fe(s.$$.fragment,c),r=z(c),c.forEach(f),this.h()},h(){y(e,"class",n="fr-col-"+(t[16].col||6))},m(l,c){A(l,e,c),de(s,e,null),h(e,r),i=!0},p(l,c){const u={};c&4&&(u.data=l[2][l[16].query]&&F({},l[7](l[2][l[16].query].data,l[16].query,l[2][l[16].query].type,l[16].chartType))),c&4&&(u.options=F({plugins:{title:{display:!0,text:l[4][l[16].query]},legend:{display:l[2][l[16].query]&&l[2][l[16].query].type==="time_series"}}},l[2][l[16].query]&&l[2][l[16].query].type==="time_series"?ce(F({},l[8]),{scales:{x:{type:"time"}}}):l[8])),s.$set(u)},i(l){i||(O(s.$$.fragment,l),i=!0)},o(l){L(s.$$.fragment,l),i=!1},d(l){l&&f(e),he(s)}}}function vt(t){let e,s,r,n,i,l,c,u,w,_,p,d,D,M,G,C,I,P,N,T,R,W,x,H,S=t[5],V=[];for(let o=0;o<S.length;o+=1)V[o]=Be(Re(t,S,o));let K=t[6],$=[];for(let o=0;o<K.length;o+=1)$[o]=ze(Ne(t,K,o));let J=t[3].filter(He).map(Je),q=[];for(let o=0;o<J.length;o+=1)q[o]=We(Le(t,J,o));const Fe=o=>L(q[o],1,1,()=>{q[o]=null});let U=t[3].filter(Ue),E=[];for(let o=0;o<U.length;o+=1)E[o]=Ge(Ae(t,U,o));const Ke=o=>L(E[o],1,1,()=>{E[o]=null});return{c(){e=g("div"),s=g("div"),r=g("div"),n=g("div"),i=g("div"),l=g("div"),c=g("label"),u=X("Plage de dates"),w=B(),_=g("select");for(let o=0;o<V.length;o+=1)V[o].c();p=B(),d=g("div"),D=g("label"),M=X("Environnement"),G=B(),C=g("select");for(let o=0;o<$.length;o+=1)$[o].c();I=B(),P=g("div"),N=g("div"),T=g("div");for(let o=0;o<q.length;o+=1)q[o].c();R=B();for(let o=0;o<E.length;o+=1)E[o].c();this.h()},l(o){e=v(o,"DIV",{class:!0});var m=b(e);s=v(m,"DIV",{class:!0});var a=b(s);r=v(a,"DIV",{class:!0});var j=b(r);n=v(j,"DIV",{class:!0});var me=b(n);i=v(me,"DIV",{class:!0});var ee=b(i);l=v(ee,"DIV",{class:!0});var te=b(l);c=v(te,"LABEL",{class:!0,for:!0});var ge=b(c);u=Y(ge,"Plage de dates"),ge.forEach(f),w=z(te),_=v(te,"SELECT",{id:!0,class:!0});var ve=b(_);for(let k=0;k<V.length;k+=1)V[k].l(ve);ve.forEach(f),te.forEach(f),p=z(ee),d=v(ee,"DIV",{class:!0});var se=b(d);D=v(se,"LABEL",{class:!0,for:!0});var be=b(D);M=Y(be,"Environnement"),be.forEach(f),G=z(se),C=v(se,"SELECT",{id:!0,class:!0});var ye=b(C);for(let k=0;k<$.length;k+=1)$[k].l(ye);ye.forEach(f),se.forEach(f),ee.forEach(f),me.forEach(f),j.forEach(f),I=z(a),P=v(a,"DIV",{class:!0});var qe=b(P);N=v(qe,"DIV",{class:!0});var Ee=b(N);T=v(Ee,"DIV",{class:!0});var re=b(T);for(let k=0;k<q.length;k+=1)q[k].l(re);R=z(re);for(let k=0;k<E.length;k+=1)E[k].l(re);re.forEach(f),Ee.forEach(f),qe.forEach(f),a.forEach(f),m.forEach(f),this.h()},h(){y(c,"class","fr-label"),y(c,"for","date"),y(_,"id","date"),y(_,"class","fr-select"),t[0]===void 0&&je(()=>t[9].call(_)),y(l,"class","fr-col-6"),y(D,"class","fr-label"),y(D,"for","cluster"),y(C,"id","cluster"),y(C,"class","fr-select"),t[1]===void 0&&je(()=>t[10].call(C)),y(d,"class","fr-col-6"),y(i,"class","fr-grid-row fr-grid-row--gutters"),y(n,"class","fr-container fr-container--fluid"),y(r,"class","fr-col-12"),y(T,"class","fr-grid-row fr-grid-row--gutters fr-grid-row--center"),y(N,"class","fr-container fr-container--fluid"),y(P,"class","fr-col-12"),y(s,"class","fr-grid-row fr-grid-row--gutters"),y(e,"class","fr-container fr-container--fluid")},m(o,m){A(o,e,m),h(e,s),h(s,r),h(r,n),h(n,i),h(i,l),h(l,c),h(c,u),h(l,w),h(l,_);for(let a=0;a<V.length;a+=1)V[a].m(_,null);ie(_,t[0]),h(i,p),h(i,d),h(d,D),h(D,M),h(d,G),h(d,C);for(let a=0;a<$.length;a+=1)$[a].m(C,null);ie(C,t[1]),h(s,I),h(s,P),h(P,N),h(N,T);for(let a=0;a<q.length;a+=1)q[a].m(T,null);h(T,R);for(let a=0;a<E.length;a+=1)E[a].m(T,null);W=!0,x||(H=[Oe(_,"change",t[9]),Oe(C,"change",t[10])],x=!0)},p(o,[m]){if(m&32){S=o[5];let a;for(a=0;a<S.length;a+=1){const j=Re(o,S,a);V[a]?V[a].p(j,m):(V[a]=Be(j),V[a].c(),V[a].m(_,null))}for(;a<V.length;a+=1)V[a].d(1);V.length=S.length}if(m&33&&ie(_,o[0]),m&64){K=o[6];let a;for(a=0;a<K.length;a+=1){const j=Ne(o,K,a);$[a]?$[a].p(j,m):($[a]=ze(j),$[a].c(),$[a].m(C,null))}for(;a<$.length;a+=1)$[a].d(1);$.length=K.length}if(m&66&&ie(C,o[1]),m&28){J=o[3].filter(He).map(Je);let a;for(a=0;a<J.length;a+=1){const j=Le(o,J,a);q[a]?(q[a].p(j,m),O(q[a],1)):(q[a]=We(j),q[a].c(),O(q[a],1),q[a].m(T,R))}for(_e(),a=J.length;a<q.length;a+=1)Fe(a);pe()}if(m&412){U=o[3].filter(Ue);let a;for(a=0;a<U.length;a+=1){const j=Ae(o,U,a);E[a]?(E[a].p(j,m),O(E[a],1)):(E[a]=Ge(j),E[a].c(),O(E[a],1),E[a].m(T,null))}for(_e(),a=U.length;a<E.length;a+=1)Ke(a);pe()}},i(o){if(!W){for(let m=0;m<J.length;m+=1)O(q[m]);for(let m=0;m<U.length;m+=1)O(E[m]);W=!0}},o(o){q=q.filter(Boolean);for(let m=0;m<q.length;m+=1)L(q[m]);E=E.filter(Boolean);for(let m=0;m<E.length;m+=1)L(E[m]);W=!1},d(o){o&&f(e),oe(V,o),oe($,o),oe(q,o),oe(E,o),x=!1,at(H)}}}let bt=50;const He=t=>t.type==="number",Je=t=>t.query,Ue=t=>t.type!=="number";function yt(t,e,s){const r=[{query:"api_requests_number",type:"number"},{query:"api_requests_date_histogram",type:"line"},{query:"decision_uniq_number",type:"number"},{query:"errors_histogram",type:"bar"},{query:"requests_ip_source",type:"bar"},{query:"latencty_date_histogram",type:"line"},{query:"pods_number",type:"number"},{query:"cpu_date_histogram",type:"line"},{query:"mem_date_histogram",type:"line"},{query:"bandwidth_date_histogram",type:"line"},{query:"top_words",type:"bar",height:"200px",col:12}],n={api_requests_number:"Appels API",api_requests_date_histogram:"Requ\xEAtes",decision_uniq_number:"D\xE9cisions consult\xE9es",errors_histogram:"Erreurs http",requests_ip_source:"Canal d'appel",latencty_date_histogram:"Latence",cpu_date_histogram:"CPU %",mem_date_histogram:"M\xE9moire",bandwidth_date_histogram:"R\xE9seau (octets)",top_words:"Recherches",pods_number:"Conteneurs"},i=[{label:"Dernier jour",start:"now-1d",end:"now",step:"30m"},{label:"Derni\xE8re heure",start:"now-1h",end:"now",step:"2m"},{label:"Derni\xE8re semaine",start:"now-7d",end:"now",step:"12h"},{label:"Dernier mois",start:"now-30d",end:"now",step:"1d"},{label:"Depuis le d\xE9but",start:"2020-01-01T00:00:00",end:"now",step:"1d"}];let l=i[0];const c=[{label:"Production",name:"judilibre-scw-prod-par2"},{label:"Secours",name:"judilibre-scw-prod-par1"},{label:"Recette",name:"judilibre-scw-dev-par1"}];let u=c[0],w={};const _=(I,P,N,T)=>{if(N==="time_series"){let R=0,W={};return I.forEach(H=>{Object.keys(H).forEach(S=>{S!=="date"&&(W[S]=!0)})}),W=Object.keys(W),{datasets:W.map(H=>({data:I.map(S=>{if(S[H])return{x:new Date(S.date),y:S[H]}}),label:H,borderColor:M[R++]}))}}else return{datasets:[{data:Object.keys(I).map(R=>I[R]),backgroundColor:M[0],label:n[P]}],labels:Object.keys(I).map(R=>d(R))}},p={"80.87.226.10":"courdecassation.fr","185.24.185.49":"piste.gouv.fr"},d=I=>p[I]||I,D={responsive:!0,animation:{duration:0},interaction:{mode:"index"},hover:{intersect:!1},elements:{point:{radius:0},line:{tension:0}}},M=["#4dc9f6","#f67019","#f53794","#537bc4","#acc236","#166a8f","#00a950","#58595b","#8549ba"];function G(){l=Se(this),s(0,l),s(5,i)}function C(){u=Se(this),s(1,u),s(6,c)}return t.$$.update=()=>{t.$$.dirty&3&&(l||u)&&r.forEach(I=>{fetch(new Request(`https://monitor.judilibre.io/stats?query=${I.query}&date_start=${l.start}&date_end=${l.end}&date_interval=${l.step}&cluster=${u.name}&size=${bt}`,{method:"GET",referer:"https://stats.judilibre.io",mode:"cors"})).then(P=>{if(P.ok)return P.json().then(N=>{s(2,w[I.query]=N[I.query],w)})})})},[l,u,w,r,n,i,c,_,D,G,C]}class qt extends le{constructor(e){super();ae(this,e,yt,vt,ne,{})}}function Et(t){let e,s,r,n,i,l,c;return l=new qt({}),{c(){e=B(),s=g("section"),r=g("div"),n=g("div"),i=g("div"),ue(l.$$.fragment),this.h()},l(u){it('[data-svelte="svelte-9qr2em"]',document.head).forEach(f),e=z(u),s=v(u,"SECTION",{});var _=b(s);r=v(_,"DIV",{class:!0});var p=b(r);n=v(p,"DIV",{class:!0});var d=b(n);i=v(d,"DIV",{class:!0});var D=b(i);fe(l.$$.fragment,D),D.forEach(f),d.forEach(f),p.forEach(f),_.forEach(f),this.h()},h(){document.title="API Judilibre - statistiques",y(i,"class","fr-col-12 fr-mt-2w"),y(n,"class","fr-grid-row fr-grid-row--gutters fr-grid-row--center"),y(r,"class","fr-container")},m(u,w){A(u,e,w),A(u,s,w),h(s,r),h(r,n),h(n,i),de(l,i,null),c=!0},p:Q,i(u){c||(O(l.$$.fragment,u),c=!0)},o(u){L(l.$$.fragment,u),c=!1},d(u){u&&f(e),u&&f(s),he(l)}}}const It=!0;class Vt extends le{constructor(e){super();ae(this,e,null,Et,ne,{})}}export{Vt as default,It as prerender};

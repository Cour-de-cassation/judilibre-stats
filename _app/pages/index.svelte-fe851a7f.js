var it=Object.defineProperty,ot=Object.defineProperties;var ct=Object.getOwnPropertyDescriptors;var Se=Object.getOwnPropertySymbols;var ut=Object.prototype.hasOwnProperty,dt=Object.prototype.propertyIsEnumerable;var Te=(t,e,r)=>e in t?it(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,U=(t,e)=>{for(var r in e||(e={}))ut.call(e,r)&&Te(t,r,e[r]);if(Se)for(var r of Se(e))dt.call(e,r)&&Te(t,r,e[r]);return t},_e=(t,e)=>ot(t,ct(e));import{S as oe,i as ce,s as ue,H as Be,e as h,k as T,c as _,a as p,d as u,n as B,b as g,f as L,F as f,I as Le,J as Me,K as Ne,x as P,u as M,E as Re,G as x,L as le,M as ft,W as ht,N as _t,O as pt,P as gt,t as ee,g as te,j as pe,m as ge,o as me,v as ve,r as be,w as ye,Q as We,R as de,T as ze,U as fe,V as mt,h as vt,X as Ge,Y as bt}from"../chunks/vendor-309c7e4b.js";const yt=t=>({}),He=t=>({}),Et=t=>({}),Je=t=>({});function wt(t){let e,r,s,a,i,l;const d=t[1].title,c=Be(d,t,t[0],Je),E=t[1].desc,y=Be(E,t,t[0],He);return{c(){e=h("div"),r=h("div"),s=h("h4"),c&&c.c(),a=T(),i=h("p"),y&&y.c(),this.h()},l(m){e=_(m,"DIV",{class:!0});var b=p(e);r=_(b,"DIV",{class:!0});var D=p(r);s=_(D,"H4",{class:!0});var W=p(s);c&&c.l(W),W.forEach(u),a=B(D),i=_(D,"P",{class:!0});var A=p(i);y&&y.l(A),A.forEach(u),D.forEach(u),b.forEach(u),this.h()},h(){g(s,"class","fr-tile__title"),g(i,"class","rf-tile__desc fr-mt-0 fr-mb-0"),g(r,"class","fr-tile__body"),g(e,"class","fr-tile")},m(m,b){L(m,e,b),f(e,r),f(r,s),c&&c.m(s,null),f(r,a),f(r,i),y&&y.m(i,null),l=!0},p(m,[b]){c&&c.p&&(!l||b&1)&&Le(c,d,m,m[0],l?Ne(d,m[0],b,Et):Me(m[0]),Je),y&&y.p&&(!l||b&1)&&Le(y,E,m,m[0],l?Ne(E,m[0],b,yt):Me(m[0]),He)},i(m){l||(P(c,m),P(y,m),l=!0)},o(m){M(c,m),M(y,m),l=!1},d(m){m&&u(e),c&&c.d(m),y&&y.d(m)}}}function qt(t,e,r){let{$$slots:s={},$$scope:a}=e;return t.$$set=i=>{"$$scope"in i&&r(0,a=i.$$scope)},[a,s]}class Dt extends oe{constructor(e){super();ce(this,e,qt,wt,ue,{})}}function It(t){let e;return{c(){e=h("canvas"),this.h()},l(r){e=_(r,"CANVAS",{style:!0}),p(e).forEach(u),this.h()},h(){Re(e,"height",t[0]||"250px")},m(r,s){L(r,e,s),t[5](e)},p(r,[s]){s&1&&Re(e,"height",r[0]||"250px")},i:x,o:x,d(r){r&&u(e),t[5](null)}}}function kt(t,e,r){let{type:s="line"}=e,{data:a}=e,{height:i}=e,{options:l={}}=e;le.register(...ft),le.register(ht,_t),le.register(pt),le.defaults.font.family='"Marianne"';let d,c,E;function y(){E=d.getContext("2d"),c&&c.destroy(),c=new le(E,{type:s,data:a,options:l})}function m(b){gt[b?"unshift":"push"](()=>{d=b,r(1,d)})}return t.$$set=b=>{"type"in b&&r(2,s=b.type),"data"in b&&r(3,a=b.data),"height"in b&&r(0,i=b.height),"options"in b&&r(4,l=b.options)},t.$$.update=()=>{t.$$.dirty&8&&a&&y()},[i,d,s,a,l,m]}class Vt extends oe{constructor(e){super();ce(this,e,kt,It,ue,{type:2,data:3,height:0,options:4})}}function Ke(t,e,r){const s=t.slice();return s[17]=e[r],s[19]=r,s}function Qe(t,e,r){const s=t.slice();return s[20]=e[r],s}function Ue(t,e,r){const s=t.slice();return s[23]=e[r],s}function Xe(t,e,r){const s=t.slice();return s[26]=e[r],s}function Ye(t){let e,r=t[26].label+"",s,a,i;return{c(){e=h("option"),s=ee(r),a=T(),this.h()},l(l){e=_(l,"OPTION",{});var d=p(e);s=te(d,r),a=B(d),d.forEach(u),this.h()},h(){e.__value=i=t[26],e.value=e.__value},m(l,d){L(l,e,d),f(e,s),f(e,a)},p:x,d(l){l&&u(e)}}}function Ze(t){let e,r=t[23].label+"",s,a,i;return{c(){e=h("option"),s=ee(r),a=T(),this.h()},l(l){e=_(l,"OPTION",{});var d=p(e);s=te(d,r),a=B(d),d.forEach(u),this.h()},h(){e.__value=i=t[23],e.value=e.__value},m(l,d){L(l,e,d),f(e,s),f(e,a)},p:x,d(l){l&&u(e)}}}function xe(t){let e,r;return e=new Dt({props:{$$slots:{desc:[$t],title:[Ct]},$$scope:{ctx:t}}}),{c(){pe(e.$$.fragment)},l(s){ge(e.$$.fragment,s)},m(s,a){me(e,s,a),r=!0},p(s,a){const i={};a&536870916&&(i.$$scope={dirty:a,ctx:s}),e.$set(i)},i(s){r||(P(e.$$.fragment,s),r=!0)},o(s){M(e.$$.fragment,s),r=!1},d(s){ve(e,s)}}}function Ct(t){let e,r=t[2][t[20]].data+"",s;return{c(){e=h("span"),s=ee(r),this.h()},l(a){e=_(a,"SPAN",{slot:!0});var i=p(e);s=te(i,r),i.forEach(u),this.h()},h(){g(e,"slot","title")},m(a,i){L(a,e,i),f(e,s)},p(a,i){i&4&&r!==(r=a[2][a[20]].data+"")&&vt(s,r)},d(a){a&&u(e)}}}function $t(t){let e,r=t[4][t[20]]+"",s;return{c(){e=h("span"),s=ee(r),this.h()},l(a){e=_(a,"SPAN",{slot:!0});var i=p(e);s=te(i,r),i.forEach(u),this.h()},h(){g(e,"slot","desc")},m(a,i){L(a,e,i),f(e,s)},p:x,d(a){a&&u(e)}}}function et(t){let e,r,s,a=t[2][t[20]]&&xe(t);return{c(){e=h("div"),a&&a.c(),r=T(),this.h()},l(i){e=_(i,"DIV",{class:!0});var l=p(e);a&&a.l(l),r=B(l),l.forEach(u),this.h()},h(){g(e,"class","fr-col")},m(i,l){L(i,e,l),a&&a.m(e,null),f(e,r),s=!0},p(i,l){i[2][i[20]]?a?(a.p(i,l),l&4&&P(a,1)):(a=xe(i),a.c(),P(a,1),a.m(e,r)):a&&(be(),M(a,1,1,()=>{a=null}),ye())},i(i){s||(P(a),s=!0)},o(i){M(a),s=!1},d(i){i&&u(e),a&&a.d()}}}function tt(t){let e,r,s,a,i;return r=new Vt({props:{height:t[17].height,type:t[17].type,data:t[2][t[17].query]&&U({},t[7](t[2][t[17].query].data,t[17].query,t[2][t[17].query].type,t[17].chartType,t[17].fill)),options:U({plugins:{datalabels:{color:"#ffffff"},title:{display:!0,text:t[4][t[17].query]},legend:{display:t[17].legend}}},t[2][t[17].query]&&t[2][t[17].query].type==="time_series"?_e(U({},t[8]),{scales:{x:{type:"time"}}}):t[8])}}),{c(){e=h("div"),pe(r.$$.fragment),s=T(),this.h()},l(l){e=_(l,"DIV",{class:!0});var d=p(e);ge(r.$$.fragment,d),s=B(d),d.forEach(u),this.h()},h(){g(e,"class",a="fr-col-12 fr-col-md-"+(t[17].col||6))},m(l,d){L(l,e,d),me(r,e,null),f(e,s),i=!0},p(l,d){const c={};d&4&&(c.data=l[2][l[17].query]&&U({},l[7](l[2][l[17].query].data,l[17].query,l[2][l[17].query].type,l[17].chartType,l[17].fill))),d&4&&(c.options=U({plugins:{datalabels:{color:"#ffffff"},title:{display:!0,text:l[4][l[17].query]},legend:{display:l[17].legend}}},l[2][l[17].query]&&l[2][l[17].query].type==="time_series"?_e(U({},l[8]),{scales:{x:{type:"time"}}}):l[8])),r.$set(c)},i(l){i||(P(r.$$.fragment,l),i=!0)},o(l){M(r.$$.fragment,l),i=!1},d(l){l&&u(e),ve(r)}}}function jt(t){let e,r,s,a,i,l,d,c,E,y,m,b,D,W,A,z,re,I,k,G,H,N,$,R,J,S,F,se,he,Ee,X=t[5],V=[];for(let o=0;o<X.length;o+=1)V[o]=Ye(Xe(t,X,o));let Y=t[6],C=[];for(let o=0;o<Y.length;o+=1)C[o]=Ze(Ue(t,Y,o));let K=t[3].filter(rt).map(lt),w=[];for(let o=0;o<K.length;o+=1)w[o]=et(Qe(t,K,o));const at=o=>M(w[o],1,1,()=>{w[o]=null});let Q=t[3].filter(st),q=[];for(let o=0;o<Q.length;o+=1)q[o]=tt(Ke(t,Q,o));const nt=o=>M(q[o],1,1,()=>{q[o]=null});return{c(){e=h("div"),r=h("div"),s=h("div"),a=h("div"),i=h("div"),l=h("div"),d=h("div"),c=h("div"),E=h("div"),y=h("label"),m=ee("Plage de dates"),b=T(),D=h("select");for(let o=0;o<V.length;o+=1)V[o].c();W=T(),A=h("div"),z=h("label"),re=ee("Environnement"),I=T(),k=h("select");for(let o=0;o<C.length;o+=1)C[o].c();G=T(),H=h("div"),N=h("div"),$=h("div");for(let o=0;o<w.length;o+=1)w[o].c();R=T(),J=h("div"),S=h("div"),F=h("div");for(let o=0;o<q.length;o+=1)q[o].c();this.h()},l(o){e=_(o,"DIV",{class:!0});var v=p(e);r=_(v,"DIV",{class:!0});var n=p(r);s=_(n,"DIV",{class:!0});var O=p(s);a=_(O,"DIV",{class:!0});var we=p(a);i=_(we,"DIV",{class:!0});var Z=p(i);l=_(Z,"DIV",{class:!0});var qe=p(l);d=_(qe,"DIV",{class:!0});var De=p(d);c=_(De,"DIV",{class:!0});var ae=p(c);E=_(ae,"DIV",{class:!0});var ne=p(E);y=_(ne,"LABEL",{class:!0,for:!0});var Ie=p(y);m=te(Ie,"Plage de dates"),Ie.forEach(u),b=B(ne),D=_(ne,"SELECT",{id:!0,class:!0});var ke=p(D);for(let j=0;j<V.length;j+=1)V[j].l(ke);ke.forEach(u),ne.forEach(u),W=B(ae),A=_(ae,"DIV",{class:!0});var ie=p(A);z=_(ie,"LABEL",{class:!0,for:!0});var Ve=p(z);re=te(Ve,"Environnement"),Ve.forEach(u),I=B(ie),k=_(ie,"SELECT",{id:!0,class:!0});var Ce=p(k);for(let j=0;j<C.length;j+=1)C[j].l(Ce);Ce.forEach(u),ie.forEach(u),ae.forEach(u),De.forEach(u),qe.forEach(u),G=B(Z),H=_(Z,"DIV",{class:!0});var $e=p(H);N=_($e,"DIV",{class:!0});var je=p(N);$=_(je,"DIV",{class:!0});var Ae=p($);for(let j=0;j<w.length;j+=1)w[j].l(Ae);Ae.forEach(u),je.forEach(u),$e.forEach(u),R=B(Z),J=_(Z,"DIV",{class:!0});var Fe=p(J);S=_(Fe,"DIV",{class:!0});var Oe=p(S);F=_(Oe,"DIV",{class:!0});var Pe=p(F);for(let j=0;j<q.length;j+=1)q[j].l(Pe);Pe.forEach(u),Oe.forEach(u),Fe.forEach(u),Z.forEach(u),we.forEach(u),O.forEach(u),n.forEach(u),v.forEach(u),this.h()},h(){g(y,"class","fr-label"),g(y,"for","date"),g(D,"id","date"),g(D,"class","fr-select"),t[0]===void 0&&We(()=>t[9].call(D)),g(E,"class","fr-col-6"),g(z,"class","fr-label"),g(z,"for","cluster"),g(k,"id","cluster"),g(k,"class","fr-select"),t[1]===void 0&&We(()=>t[10].call(k)),g(A,"class","fr-col-6"),g(c,"class","fr-grid-row fr-grid-row--gutters"),g(d,"class","fr-container fr-container--fluid"),g(l,"class","fr-col-12"),g($,"class","fr-grid-row fr-grid-row--gutters fr-grid-row--center"),g(N,"class","fr-container fr-container--fluid"),g(H,"class","fr-col-12"),g(F,"class","fr-grid-row fr-grid-row--gutters fr-grid-row--center"),g(S,"class","fr-container fr-container--fluid"),g(J,"class","fr-col-12"),g(i,"class","fr-grid-row fr-grid-row--gutters fr-grid-row--center"),g(a,"class","fr-container fr-container--fluid"),g(s,"class","fr-col-12"),g(r,"class","fr-grid-row fr-grid-row--gutters"),g(e,"class","fr-container fr-container--fluid")},m(o,v){L(o,e,v),f(e,r),f(r,s),f(s,a),f(a,i),f(i,l),f(l,d),f(d,c),f(c,E),f(E,y),f(y,m),f(E,b),f(E,D);for(let n=0;n<V.length;n+=1)V[n].m(D,null);de(D,t[0]),f(c,W),f(c,A),f(A,z),f(z,re),f(A,I),f(A,k);for(let n=0;n<C.length;n+=1)C[n].m(k,null);de(k,t[1]),f(i,G),f(i,H),f(H,N),f(N,$);for(let n=0;n<w.length;n+=1)w[n].m($,null);f(i,R),f(i,J),f(J,S),f(S,F);for(let n=0;n<q.length;n+=1)q[n].m(F,null);se=!0,he||(Ee=[ze(D,"change",t[9]),ze(k,"change",t[10])],he=!0)},p(o,[v]){if(v&32){X=o[5];let n;for(n=0;n<X.length;n+=1){const O=Xe(o,X,n);V[n]?V[n].p(O,v):(V[n]=Ye(O),V[n].c(),V[n].m(D,null))}for(;n<V.length;n+=1)V[n].d(1);V.length=X.length}if(v&33&&de(D,o[0]),v&64){Y=o[6];let n;for(n=0;n<Y.length;n+=1){const O=Ue(o,Y,n);C[n]?C[n].p(O,v):(C[n]=Ze(O),C[n].c(),C[n].m(k,null))}for(;n<C.length;n+=1)C[n].d(1);C.length=Y.length}if(v&66&&de(k,o[1]),v&28){K=o[3].filter(rt).map(lt);let n;for(n=0;n<K.length;n+=1){const O=Qe(o,K,n);w[n]?(w[n].p(O,v),P(w[n],1)):(w[n]=et(O),w[n].c(),P(w[n],1),w[n].m($,null))}for(be(),n=K.length;n<w.length;n+=1)at(n);ye()}if(v&412){Q=o[3].filter(st);let n;for(n=0;n<Q.length;n+=1){const O=Ke(o,Q,n);q[n]?(q[n].p(O,v),P(q[n],1)):(q[n]=tt(O),q[n].c(),P(q[n],1),q[n].m(F,null))}for(be(),n=Q.length;n<q.length;n+=1)nt(n);ye()}},i(o){if(!se){for(let v=0;v<K.length;v+=1)P(w[v]);for(let v=0;v<Q.length;v+=1)P(q[v]);se=!0}},o(o){w=w.filter(Boolean);for(let v=0;v<w.length;v+=1)M(w[v]);q=q.filter(Boolean);for(let v=0;v<q.length;v+=1)M(q[v]);se=!1},d(o){o&&u(e),fe(V,o),fe(C,o),fe(w,o),fe(q,o),he=!1,mt(Ee)}}}let At=50;const rt=t=>t.type==="number",lt=t=>t.query,st=t=>t.type!=="number";function Ft(t,e,r){const s=[{query:"api_requests_number",type:"number"},{query:"decision_uniq_number",type:"number"},{query:"pods_number",type:"number"},{query:"api_requests_date_histogram",type:"line",legend:!0},{query:"errors_histogram",type:"bar",legend:!1},{query:"requests_ip_source",type:"pie",legend:!0},{query:"latencty_date_histogram",type:"line",fill:!0,legend:!0},{query:"cpu_date_histogram",type:"line",fill:!0,legend:!0},{query:"mem_date_histogram",type:"line",fill:!0,legend:!0},{query:"bandwidth_date_histogram",type:"line",legend:!1},{query:"top_words",type:"bar",height:"400px",col:12,legend:!1}],a={api_requests_number:"Appels API",api_requests_date_histogram:"Requ\xEAtes",decision_uniq_number:"D\xE9cisions consult\xE9es",errors_histogram:"Erreurs http",requests_ip_source:"Canal d'appel",latencty_date_histogram:"Latence",cpu_date_histogram:"CPU %",mem_date_histogram:"M\xE9moire",bandwidth_date_histogram:"R\xE9seau (octets)",top_words:"Recherches",pods_number:"Conteneurs"},i=[{label:"Dernier jour",start:"now-1d",end:"now",step:"1h"},{label:"Derni\xE8re heure",start:"now-1h",end:"now",step:"1m"},{label:"Derni\xE8re semaine",start:"now-7d",end:"now",step:"4h"},{label:"Dernier mois",start:"now-30d",end:"now",step:"1d"},{label:"Depuis le d\xE9but",start:"2020-01-01T00:00:00",end:"now",step:"1d"}];let l=i[0];const d=[{label:"Production",name:"judilibre-scw-prod-par2"},{label:"Secours",name:"judilibre-scw-prod-par1"},{label:"Recette",name:"judilibre-scw-dev-par1"}];let c=d[0],E={};const y=(I,k,G,H,N)=>{if(G==="time_series"){let $=0,R={};return I.forEach(S=>{Object.keys(S).forEach(F=>{F!=="date"&&(R[F]=!0)})}),R=Object.keys(R),R.includes("Mem.total")&&(R=["Mem.used.min","Mem.used.mean","Mem.used.max","Mem.total"]),{datasets:R.map(S=>({data:I.map(F=>{if(F[S])return{x:new Date(F.date),y:F[S]}}),label:S,borderColor:A[$++],borderWidth:N?0:void 0,fill:N?"origin":void 0,backgroundColor:N?`#000091${9-2*$}${9-2*$}`:void 0}))}}else return{datasets:[{data:Object.keys(I).map($=>I[$]),backgroundColor:A,borderWidth:0,label:a[k]}],labels:Object.keys(I).map($=>b($))}},m={"80.87.226.10":"courdecassation.fr","185.24.185.49":"piste.gouv.fr"},b=I=>m[I]||I,D={responsive:!0,maintainAspectRatio:!1,animation:{duration:0},interaction:{mode:"index"},hover:{intersect:!1},elements:{point:{radius:0},line:{tension:0}}},W={"F-blue-soft":"#5770BE","N-orange-dark":"#E18863","E-green-soft":"#00AC8C","L-yellow-dark":"#FDCF41","Q-brown":"#A26859","J-pink-light":"#FFC29E","$blue-france":"#000091","$red-marianne":"#E1000F","A-green-warm":"#958B62","B-green-light":"#91AE4F","C-green-warm":"#169B62","G-blue-dark":"#484D7A","H-pink-soft":"#FF8D7E","I-pink-dark":"#D08A77","K-yellow-medium":"#FFE800","M-orange-medium":"#FF9940","O-orange-soft":"#FF6F4C","P-purple":"#7D4E5B"},A=Object.keys(W).map(I=>W[I]);function z(){l=Ge(this),r(0,l),r(5,i)}function re(){c=Ge(this),r(1,c),r(6,d)}return t.$$.update=()=>{t.$$.dirty&3&&(l||c)&&s.forEach(I=>{fetch(new Request(`https://monitor.judilibre.io/stats?query=${I.query}&date_start=${l.start}&date_end=${l.end}&date_interval=${l.step}&cluster=${c.name}&size=${At}`,{method:"GET",referer:"https://stats.judilibre.io",mode:"cors"})).then(k=>{if(k.ok)return k.json().then(G=>{r(2,E[I.query]=G[I.query],E)})})})},[l,c,E,s,a,i,d,y,D,z,re]}class Ot extends oe{constructor(e){super();ce(this,e,Ft,jt,ue,{})}}function Pt(t){let e,r,s,a,i,l,d;return l=new Ot({}),{c(){e=T(),r=h("section"),s=h("div"),a=h("div"),i=h("div"),pe(l.$$.fragment),this.h()},l(c){bt('[data-svelte="svelte-9qr2em"]',document.head).forEach(u),e=B(c),r=_(c,"SECTION",{});var y=p(r);s=_(y,"DIV",{class:!0});var m=p(s);a=_(m,"DIV",{class:!0});var b=p(a);i=_(b,"DIV",{class:!0});var D=p(i);ge(l.$$.fragment,D),D.forEach(u),b.forEach(u),m.forEach(u),y.forEach(u),this.h()},h(){document.title="API Judilibre - statistiques",g(i,"class","fr-col-12 fr-mt-2w"),g(a,"class","fr-grid-row fr-grid-row--gutters fr-grid-row--center"),g(s,"class","fr-container")},m(c,E){L(c,e,E),L(c,r,E),f(r,s),f(s,a),f(a,i),me(l,i,null),d=!0},p:x,i(c){d||(P(l.$$.fragment,c),d=!0)},o(c){M(l.$$.fragment,c),d=!1},d(c){c&&u(e),c&&u(r),ve(l)}}}const Bt=!0;class Lt extends oe{constructor(e){super();ce(this,e,null,Pt,ue,{})}}export{Lt as default,Bt as prerender};
